{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createMarkupItem = images => {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n  <li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${webformatURL}\"\n      alt=\"${tags}\"\n    />\n  </a>\n    <div class=\"small-content\">\n        <small class=\"text-body-likes\"><span class=\"text-body\">Likes:</span> <span class=\"quantity\">${likes}</span></small>\n        <small class=\"text-body-views\"><span class=\"text-body\">Views:</span> <span class=\"quantity\">${views}</span></small>\n        <small class=\"text-body-comments\"><span class=\"text-body\">Comments:</span> <span class=\"quantity\">${comments}</span></small>\n        <small class=\"text-body-downloads\"><span class=\"text-body\">Dowloads:</span> <span class=\"quantity\">${downloads}</span></small>\n    </div>\n \n    </li>\n`;\n      }\n    )\n    .join('');\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '43896740-362a21d10e9d41ec216c05f15';\n\nexport const fetchPhotosByQuery = async (query, page = 1, perPage = 15) => {\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page: perPage,\n  });\n\n  try {\n    const response = await axios.get(`${BASE_URL}?${searchParams}`);\n    // if (response.status !== 200) {\n    //   throw new Error(response.statusText);\n    // }\n    return response.data;\n  } catch (error) {\n    console.log(error);\n    throw error;\n  }\n};\n","import { createMarkupItem } from './js/render-functions.js';\nimport { fetchPhotosByQuery } from './js/pixabay-api.js';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst galleryEl = document.querySelector('.js-gallery');\nconst searchFormEl = document.querySelector('.js-search-form');\nconst loadMoreBtnEl = document.querySelector('.js-load-more');\nconst loaderEl = document.querySelector('.js-loader');\n\nlet currentPage = 1;\nlet currentQuery = '';\nconst perPage = 15;\nlet lightbox = new SimpleLightbox('.js-gallery a');\nlet totalHits = 0;\n\nasync function onSearchFormSubmit(event) {\n  event.preventDefault();\n  currentQuery = event.target.elements.searchKeyword.value.trim();\n\n  if (currentQuery === '') {\n    galleryEl.innerHTML = '';\n    event.target.reset();\n    iziToast.error({\n      title: 'Error',\n      message: 'Illegal operation',\n      position: 'topRight',\n      timeout: 2000,\n    });\n    return;\n  }\n  currentPage = 1;\n  totalHits = 0;\n  galleryEl.innerHTML = '';\n  loadMoreBtnEl.classList.add('is-hidden');\n  loaderEl.classList.remove('is-hidden');\n\n  try {\n    const imagesData = await fetchPhotosByQuery(\n      currentQuery,\n      currentPage,\n      perPage\n    );\n    totalHits = imagesData.totalHits;\n    if (totalHits === 0) {\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        timeout: 2000,\n        color: 'red',\n      });\n    } else {\n      galleryEl.innerHTML = createMarkupItem(imagesData.hits);\n      lightbox.refresh();\n      if (\n        imagesData.hits.length < perPage ||\n        totalHits <= currentPage * perPage\n      ) {\n        iziToast.show({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n          timeout: 2000,\n          color: 'red',\n        });\n        loadMoreBtnEl.classList.add('is-hidden');\n      } else {\n        loadMoreBtnEl.classList.remove('is-hidden');\n      }\n    }\n  } catch (error) {\n    console.log(error);\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to fetch images. Please try again later.',\n      position: 'topRight',\n      timeout: 2000,\n    });\n  } finally {\n    event.target.reset();\n    loaderEl.classList.add('is-hidden');\n  }\n}\n\nasync function onLoadMoreClick() {\n  currentPage += 1;\n  loaderEl.classList.remove('is-hidden');\n  loadMoreBtnEl.classList.add('is-hidden');\n\n  try {\n    const imagesData = await fetchPhotosByQuery(\n      currentQuery,\n      currentPage,\n      perPage\n    );\n\n    const newMarkup = createMarkupItem(imagesData.hits);\n    galleryEl.insertAdjacentHTML('beforeend', newMarkup);\n    lightbox.refresh();\n    loadMoreBtnEl.classList.remove('is-hidden');\n\n    if (imagesData.hits.length === 0 || totalHits <= currentPage * perPage) {\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 2000,\n        color: 'red',\n      });\n      loadMoreBtnEl.classList.add('is-hidden');\n    }\n\n    // Scroll page to the new images\n    const { height: cardHeight } =\n      galleryEl.firstElementChild.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to fetch images. Please try again later.',\n      position: 'topRight',\n      timeout: 2000,\n    });\n  } finally {\n    loaderEl.classList.add('is-hidden');\n  }\n}\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtnEl.addEventListener('click', onLoadMoreClick);\n"],"names":["createMarkupItem","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","BASE_URL","API_KEY","fetchPhotosByQuery","query","page","perPage","searchParams","axios","error","galleryEl","searchFormEl","loadMoreBtnEl","loaderEl","currentPage","currentQuery","lightbox","SimpleLightbox","totalHits","onSearchFormSubmit","event","iziToast","imagesData","onLoadMoreClick","newMarkup","cardHeight"],"mappings":"owBAAO,MAAMA,EAAmBC,GACvBA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA;AAAA,kCAEmBL,CAAa;AAAA;AAAA;AAAA,aAGlCD,CAAY;AAAA,aACZE,CAAI;AAAA;AAAA;AAAA;AAAA,sGAIqFC,CAAK;AAAA,sGACLC,CAAK;AAAA,4GACCC,CAAQ;AAAA,6GACPC,CAAS;AAAA;AAAA;AAAA;AAAA,CAMjH,EACA,KAAK,EAAE,EC7BNC,EAAW,2BACXC,EAAU,qCAEHC,EAAqB,MAAOC,EAAOC,EAAO,EAAGC,EAAU,KAAO,CACzE,MAAMC,EAAe,IAAI,gBAAgB,CACvC,IAAKL,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAUC,CACd,CAAG,EAED,GAAI,CAKF,OAJiB,MAAME,EAAM,IAAI,GAAGP,CAAQ,IAAIM,CAAY,EAAE,GAI9C,IACjB,OAAQE,EAAO,CACd,cAAQ,IAAIA,CAAK,EACXA,CACP,CACH,ECpBMC,EAAY,SAAS,cAAc,aAAa,EAChDC,EAAe,SAAS,cAAc,iBAAiB,EACvDC,EAAgB,SAAS,cAAc,eAAe,EACtDC,EAAW,SAAS,cAAc,YAAY,EAEpD,IAAIC,EAAc,EACdC,EAAe,GACnB,MAAMT,EAAU,GAChB,IAAIU,EAAW,IAAIC,EAAe,eAAe,EAC7CC,EAAY,EAEhB,eAAeC,EAAmBC,EAAO,CAIvC,GAHAA,EAAM,eAAc,EACpBL,EAAeK,EAAM,OAAO,SAAS,cAAc,MAAM,OAErDL,IAAiB,GAAI,CACvBL,EAAU,UAAY,GACtBU,EAAM,OAAO,QACbC,EAAS,MAAM,CACb,MAAO,QACP,QAAS,oBACT,SAAU,WACV,QAAS,GACf,CAAK,EACD,MACD,CACDP,EAAc,EACdI,EAAY,EACZR,EAAU,UAAY,GACtBE,EAAc,UAAU,IAAI,WAAW,EACvCC,EAAS,UAAU,OAAO,WAAW,EAErC,GAAI,CACF,MAAMS,EAAa,MAAMnB,EACvBY,EACAD,EACAR,CACN,EACIY,EAAYI,EAAW,UACnBJ,IAAc,EAChBG,EAAS,KAAK,CACZ,QACE,2EACF,SAAU,WACV,QAAS,IACT,MAAO,KACf,CAAO,GAEDX,EAAU,UAAYlB,EAAiB8B,EAAW,IAAI,EACtDN,EAAS,QAAO,EAEdM,EAAW,KAAK,OAAShB,GACzBY,GAAaJ,EAAcR,GAE3Be,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,WACV,QAAS,IACT,MAAO,KACjB,CAAS,EACDT,EAAc,UAAU,IAAI,WAAW,GAEvCA,EAAc,UAAU,OAAO,WAAW,EAG/C,OAAQH,EAAO,CACd,QAAQ,IAAIA,CAAK,EACjBY,EAAS,MAAM,CACb,MAAO,QACP,QAAS,kDACT,SAAU,WACV,QAAS,GACf,CAAK,CACL,QAAY,CACRD,EAAM,OAAO,QACbP,EAAS,UAAU,IAAI,WAAW,CACnC,CACH,CAEA,eAAeU,GAAkB,CAC/BT,GAAe,EACfD,EAAS,UAAU,OAAO,WAAW,EACrCD,EAAc,UAAU,IAAI,WAAW,EAEvC,GAAI,CACF,MAAMU,EAAa,MAAMnB,EACvBY,EACAD,EACAR,CACN,EAEUkB,EAAYhC,EAAiB8B,EAAW,IAAI,EAClDZ,EAAU,mBAAmB,YAAac,CAAS,EACnDR,EAAS,QAAO,EAChBJ,EAAc,UAAU,OAAO,WAAW,GAEtCU,EAAW,KAAK,SAAW,GAAKJ,GAAaJ,EAAcR,KAC7De,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,WACV,QAAS,IACT,MAAO,KACf,CAAO,EACDT,EAAc,UAAU,IAAI,WAAW,GAIzC,KAAM,CAAE,OAAQa,CAAY,EAC1Bf,EAAU,kBAAkB,wBAC9B,OAAO,SAAS,CACd,IAAKe,EAAa,EAClB,SAAU,QAChB,CAAK,CACF,OAAQhB,EAAO,CACd,QAAQ,MAAMA,CAAK,EACnBY,EAAS,MAAM,CACb,MAAO,QACP,QAAS,kDACT,SAAU,WACV,QAAS,GACf,CAAK,CACL,QAAY,CACRR,EAAS,UAAU,IAAI,WAAW,CACnC,CACH,CAEAF,EAAa,iBAAiB,SAAUQ,CAAkB,EAC1DP,EAAc,iBAAiB,QAASW,CAAe"}